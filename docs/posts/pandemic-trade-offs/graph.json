{
	"$schema": "https://vega.github.io/schema/vega/v5.json",
	"autosize": { "type": "fit", "contains": "padding" },
	"padding": 0,
	"config": {
		"axis": {
			"labelFont": "Source Sans Pro, sans-serif",
			"titleFont": "Source Sans Pro, sans-serif",
			"titleFontSize": 20,
			"titleColor": "#012a58",
			"titleFontWeight": 400
		},
		"legend": {
			"labelFont": "Source Sans Pro, sans-serif",
			"titleFont": "Source Sans Pro, sans-serif"
		},
		"title": {
			"font": "Source Sans Pro, sans-serif",
			"subtitleFont": "Source Sans Pro, sans-serif"
		}
	},

	"description": "New cases from ABM.",
	"data": {
		"name": "main",
		"format": {"type": "csv", "parse": "auto"},
		"url": "/posts/SARS-CoV-2/dummy_ABM_data.csv",
		"transform": [
			{ "type": "filter", "expr": "datum.vaccine_uptake === VaccineUptake" },
			{ "type": "filter", "expr": "datum.v1_transmission_effectiveness === PfizerTransmissionReduction" },
			{ "type": "filter", "expr": "datum.v2_transmission_effectiveness === AstraZenecaTransmissionReduction" },
			{ "type": "filter", "expr": "datum.strategy === Strategy" },
			{ "type": "filter", "expr": "datum.relax_triggers === StrategyRelaxation" }
		]
	},

	"signals": [
		{
			"name": "width",
			"init": "containerSize()[0]",
			"on": [{ "events": "window:resize", "update": "containerSize()[0]" }]
		},
		{
			"name": "height",
			"init": "containerSize()[1]",
			"on": [{ "events": "window:resize", "update": "containerSize()[1]" }]
		},
		{
			"name": "conditionSet",
			"update": "100",
			"on": [
				{
					"events": {
						"source": "#select-ABM-condition-set",
						"type": "change"
					},
					"update": "toNumber(event.target.value)"
				}
			]
		},
		{
			"name": "PfizerTransmissionReduction",
			"update": "50",
			"on": [
				{
					"events": {
						"source": "#select-ABM-pfizer-transmission-reduction",
						"type": "change"
					},
					"update": "toNumber(event.target.value)"
				}
			]
		},
		{
			"name": "AstraZenecaTransmissionReduction",
			"update": "50",
			"on": [
				{
					"events": {
						"source": "#select-ABM-astrazeneca-transmission-reduction",
						"type": "change"
					},
					"update": "toNumber(event.target.value)"
				}
			]
		},
		{
			"name": "VaccineUptake",
			"update": "60",
			"on": [
				{
					"events": {
						"source": "#select-ABM-vaccine-uptake",
						"type": "change"
					},
					"update": "toNumber(event.target.value)"
				}
			]
		},
		{
			"name": "Strategy",
			"update": "'Aggressive Elimination'",
			"on": [
				{
					"events": {
						"source": "#select-ABM-strategy",
						"type": "change"
					},
					"update": "event.target.value"
				}
			]
		},
		{
			"name": "StrategyRelaxation",
			"update": "'No'",
			"on": [
				{
					"events": {
						"source": "#select-ABM-strategy-relaxation",
						"type": "change"
					},
					"update": "event.target.value"
				}
			]
		}
	],

	"scales": [
		{
			"name": "x",
			"type": "linear",
			"range": "width",
			"domain": [0, 365]
		},
		{
			"name": "y",
			"type": "linear",
			"range": "height",
			"domain": [0, 1200]
		}
	],

	"axes": [
		{
			"orient": "bottom",
			"scale": "x",
			"title": "Days since start of simulation",
			"titleY": 50
		},
		{
			"orient": "left",
			"scale": "y",
			"title": "New cases each day",
			"titleX": -50
		}
	],

	"marks": [
		{
			"type": "group",
			"from": {
				"facet": {
					"name": "series",
					"data": "main",
					"groupby": ["trace", "condition_set"]
				}
			},
			"marks": [
				{
					"type": "line",
					"from": {"data": "series"},
					"encode": {
						"enter": {
							"x": {"scale": "x", "field": "day"},
							"y": {"scale": "y", "field": "new_cases"},
							"strokeWidth": {"value": 1}
						}
					}
				}
			]
		}
	],

	"uom-title": "SARS-CoV-2 Case Modelling",

	"uom-toggles": {
		"toggle-groups": [
			{
				"name": "Vaccine Effectiveness",
				"toggles": [
					{
						"name": "Pfizer Transmission Reduction",
						"description": "Percentage by which the Pfizer vaccine reduces transmission.",
						"type": "select",
						"values": [50, 75, 90]
					},
					{
						"name": "AstraZeneca Transmission Reduction",
						"description": "Percentage by which the Pfizer vaccine reduces transmission.",
						"type": "select",
						"values": [50, 75, 90]
					}
				]
			},
			{
				"name": "Public Response",
				"toggles": [
					{
						"name": "Vaccine Uptake",
						"description": "Percentage of people who accept vaccination when available.",
						"type": "select",
						"values": [60, 75, 90]
					}
				]
			},
			{
				"name": "Government Response",
				"toggles": [
					{
						"name": "Strategy",
						"description": "Government strategy for moving between different levels of restrictions.",
						"type": "select",
						"values": [
							"Aggressive Elimination",
							"Moderate Elimination",
							"Tight Suppression",
							"Loose Suppression"
						]
					},
					{
						"name": "Strategy Relaxation",
						"description": "Relax the triggers for each strategy as vaccinations progress?",
						"type": "select",
						"values": [
							"No",
							"Yes"
						]
					}
				]
			}
		]
	}
}
